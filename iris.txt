
import pandas as pd
import matplotlib.pyplot as plt
from sklearn.datasets import load_iris
from sklearn.model_selection import train_test_split
from sklearn.linear_model import LogisticRegression, LinearRegression
from sklearn.metrics import accuracy_score
import numpy as np

# ==========================================
# ğŸŒ¸ Part 1: ë¶„ë¥˜ - ë¶“ê½ƒ ì¢…ë¥˜ ë§ì¶”ê¸°
# ==========================================
print("\nğŸ“š Part 1: ë¶„ë¥˜ ë¬¸ì œ")
print("ëª©í‘œ: ê½ƒì˜ í¬ê¸°ë¡œ ë¶“ê½ƒ ì¢…ë¥˜ë¥¼ ë§ì¶°ë³´ì!")

# 1ë‹¨ê³„: ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
print("\n1ë‹¨ê³„: ë°ì´í„° ì¤€ë¹„")
iris = load_iris()
flower_data = iris.data          # ê½ƒì˜ í¬ê¸° ì •ë³´
flower_type = iris.target        # ì •ë‹µ (ì–´ë–¤ ì¢…ë¥˜ì¸ì§€)

print(f"ê½ƒ ë°ì´í„° ê°œìˆ˜: {len(flower_data)}ê°œ")
print(f"ê½ƒ ì¢…ë¥˜: {iris.target_names}")  # ['setosa' 'versicolor' 'virginica']

# 2ë‹¨ê³„: ë°ì´í„° ì‚´í´ë³´ê¸°
print("\n2ë‹¨ê³„: ë°ì´í„° ë¯¸ë¦¬ë³´ê¸°")
# ì²˜ìŒ 5ê°œ ê½ƒì˜ ì •ë³´
print("ì²˜ìŒ 5ê°œ ê½ƒì˜ í¬ê¸°:")
for i in range(5):
    print(f"ê½ƒ {i+1}: {flower_data[i]} â†’ ì¢…ë¥˜: {iris.target_names[flower_type[i]]}")

# 3ë‹¨ê³„: í›ˆë ¨ìš©ê³¼ í…ŒìŠ¤íŠ¸ìš©ìœ¼ë¡œ ë‚˜ëˆ„ê¸°
print("\n3ë‹¨ê³„: ë°ì´í„° ë‚˜ëˆ„ê¸°")
X_train, X_test, y_train, y_test = train_test_split(
    flower_data, flower_type, test_size=0.3, random_state=42)

print(f"í›ˆë ¨ìš© ë°ì´í„°: {len(X_train)}ê°œ")
print(f"í…ŒìŠ¤íŠ¸ìš© ë°ì´í„°: {len(X_test)}ê°œ")

# 4ë‹¨ê³„: AI ëª¨ë¸ ë§Œë“¤ê¸°
print("\n4ë‹¨ê³„: AI ëª¨ë¸ í›ˆë ¨")
classification_model = LogisticRegression()
classification_model.fit(X_train, y_train)  # í›ˆë ¨í•˜ê¸°
print("âœ… ëª¨ë¸ í›ˆë ¨ ì™„ë£Œ!")

# 5ë‹¨ê³„: ì˜ˆì¸¡í•´ë³´ê¸°
print("\n5ë‹¨ê³„: ì˜ˆì¸¡ ê²°ê³¼")
predictions = classification_model.predict(X_test)
accuracy = accuracy_score(y_test, predictions)

print(f"ì •í™•ë„: {accuracy:.2f} ({accuracy*100:.1f}%)")

# ëª‡ ê°œ ì˜ˆì¸¡ ê²°ê³¼ ë³´ì—¬ì£¼ê¸°
print("\nì˜ˆì¸¡ ê²°ê³¼ ì˜ˆì‹œ:")
for i in range(5):
    actual = iris.target_names[y_test[i]]
    predicted = iris.target_names[predictions[i]]
    correct = "O" if actual == predicted else "X"
    print(f"ì‹¤ì œ: {actual:10} | ì˜ˆì¸¡: {predicted:10} {correct}")